<!DOCTYPE html>
<html>
  <head>
    <title>Formulario de Author</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  </head>

  <body>
    <div class="container">
      <h1> New Author </h1>

      <form id="book-form">
        <label for="first_name" class="form-label">First Name</label>
        <input type="text" class="form-control" id="first_name" name="first_name">
        <label for="last_name" class="form-label">Last Name</label>
        <input type="text" class="form-control" id="last_name" name="last_name">
        <label for="age" class="form-label">Age</label>
        <input type="number" class="form-control" id="age" name="age">
        <button type="submit" class="btn btn-primary">Create Author</button>
      </form>

        <div id="response"></div>
        <div id="error"></div>
    </div>

    <script>
      document.getElementById("book-form").addEventListener("submit", function (event) {
        event.preventDefault(); // Prevent the page from refreshing when submitting the form

        const first_name = document.getElementById("first_name").value;
        const last_name = document.getElementById("last_name").value;
        const age = document.getElementById("age").value;

        var bookParams = {
          first_name: first_name,
          last_name: last_name,
          age: age
        };

        fetch("http://localhost:3000/authors", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          body: JSON.stringify(bookParams)
        }).then(function (response) {
          if (!response.ok) {
            throw new Error('No se creo el author');
          }
          return response.json(); // Convertir la respuesta en un objeto JSON
        })
          .then(function (data) {
            // Mostrar la respuesta exitosa en el HTML
            var responseDiv = document.getElementById('response');
            console.log(data);
            responseDiv.innerText = JSON.stringify(data);
            responseDiv.style.color = 'green';
          })
          .catch(function (error) {
            // Mostrar el error en el HTML
            var errorDiv = document.getElementById('error');
            errorDiv.innerText = error.message;
            errorDiv.style.color = 'red';
          });
      });
    </script>
  </body>
</html>